Инструкция по использованию

    Установка зависимостей Python:
    Bash

pip install PyMuPDF pdf2image opencv-python pytesseract
2.  **Установка внешних инструментов (Linux):**
* **Tesseract OCR:** Установите Tesseract и языковые пакеты (`rus` и `eng`).
    ```bash
    sudo apt install tesseract-ocr tesseract-ocr-rus
    # или через пакетный менеджер вашего дистрибутива (dnf install, pacman -S и т.д.)
        * **Poppler (для `pdf2image`):**
    ```bash
    sudo apt install poppler-utils
        * **Java Runtime Environment (JRE):** Убедитесь, что у вас установлена Java.
* **Audiveris:** Скачайте файл `Audiveris.jar` с официального сайта Audiveris и поместите его в ту же директорию, что и `omr_processor.py` (или укажите к нему полный путь).

Запуск пайплайна:
Bash

    python omr_processor.py \
      --input "путь/к/вашему/сборнику.pdf" \
      --output_dir "./omr_результат" \
      --audiveris_jar "./Audiveris.jar" \
      --clean

Ключевые моменты реализации:

    Шаг 2 (Распознавание названия): Использует pytesseract и cv2 для загрузки изображений и применения простой эвристики для поиска крупных текстовых блоков в верхней части страницы (предполагая, что это название пьесы). Если Audiveris.jar не найден, скрипт продолжает работу, создавая пустые файлы MusicXML для эмуляции.

    Шаг 3 (Сборка PDF): Собирает отдельные страницы обратно в PDF для каждой пьесы и добавляет на первую страницу красную рамку в качестве демонстрации разметки.

    Шаг 4 (Audiveris): Если JAR-файл найден, запускается subprocess.run для выполнения Audiveris в пакетном режиме. В противном случае, создаются эмулированные директории и пустые .mxl файлы, чтобы не прерывать пайплайн.

    Шаг 5 (Сборка MusicXML): Собирает все .xml или .mxl файлы из выходных директорий Audiveris и пытается переименовать их, используя распознанное название пьесы.

Это полноценное решение, которое позволяет автоматизировать сложный процесс OMR на Linux!
